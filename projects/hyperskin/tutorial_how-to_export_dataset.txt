data_module.export_dataset(
        output_dir="export/hsi_dermoscopy_croppedv2_256_with_masks",
        # splits=["train", "val", "test"],
        crop_with_mask=True,
        bbox_scale=2,
        structure="original",
        image_size=image_size,
        allowed_labels=["melanoma", "dysplastic_nevi"],
        global_normalization=False,
        export_cropped_masks=True,
    )

python src/main.py predict -c logs/hypersynth/fastgan_cpkt/config.yaml --ckpt_path logs/hypersynth/fastgan_cpkt/checkpoints/j7od0bbk_fastgan_melanoma_step=0-val_MIFID=114.7889.ckpt


class  ImageFolder(Dataset):
    """docstring for ArtDataset"""
    def _init_(self, root, transform=None):
        super( ImageFolder, self)._init_()
        self.root = root

        self.frame = self._parse_frame()
        self.transform = transform

    def _parse_frame(self):
        frame = []
        img_names = os.listdir(self.root)
        img_names.sort()
        for i in range(len(img_names)):
            image_path = os.path.join(self.root, img_names[i])
            if image_path[-4:] == '.jpg' or image_path[-4:] == '.png' or image_path[-5:] == '.jpeg': 
                frame.append(image_path)
        return frame

    def _len_(self):
        return len(self.frame)

    def _getitem_(self, idx):
        file = self.frame[idx]
        img = Image.open(file).convert('RGB')
            
        if self.transform:
            img = self.transform(img) 

        return img

  